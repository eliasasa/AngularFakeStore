<app-banner></app-banner>
<div class="container categorias-container">
    <div class="row">
        <div class="filter-container">
            <app-filter 
                #filterComp 
                [filters]="filters" 
                >
            </app-filter>
        </div>
    </div>
    
    <!-- Estados de carregamento e erro -->
    @if (loading) {
        <app-load class="home-load" [message]="{message: 'Carregando produtos...'}"></app-load>
    }
    
    @if (error && !loading) {
        <div class="error-state">
            <p>Não foi possível carregar os produtos</p>
            <button mat-button (click)="loadProducts(globalService.getSharedValue())">Tentar novamente</button>
        </div>
    }
    
    @if (!loading && !error) {
        <div class="product-container">
            <div class="card-grid">
                @for (product of products; track product.id) {
                    <app-product-card [product]="{
                      id: product.id,
                      title: product.title,
                      price: product.price,
                      image: product.image,
                    }"></app-product-card>
                }
            </div>
        </div>

        <app-product-list
            [icon]="'hotel_class'"
            [title]="'Mais avaliados'"
            [products]="productsByRate"
            emptyMessage="'Alguma coisa deu errado :/'"
            [rowClass]="true"
        ></app-product-list>

        <app-product-list
            [icon]="'trending_up'"
            [title]="'Mais vendidos'"
            [products]="productsByCount"
            emptyMessage="'Alguma coisa deu errado :/'"
            [rowClass]="true"
        ></app-product-list>
        <!-- <app-product-list 
            [icon]="'history'"
            [title]="'Vistos por você'"
            [products]="viewedProduct"
            [emptyMessage]="'Assim que você visualizar produtos, eles aparecerão aqui.'"
        ></app-product-list> -->
    }

</div>
